<!DOCTYPE html><html lang="en-us"><head><link rel="shortcut icon" type="image/png" sizes="16x16" href="https://dsc-spidal.github.io/harp/img/favicon-16x9.png"><link rel="shortcut icon" type="image/png" sizes="32x32" href="https://dsc-spidal.github.io/harp/img/favicon-32x18.png"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="Hugo 0.18" /><meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="harp"><meta property="og:image" content="/img/logo54x54.png"><meta property="og:url" content="https://dsc-spidal.github.io/harp/"><meta name="twitter:title" content="harp"><meta name="twitter:image" content="/img/0-1-1.png"><meta property="og:site_name" content="Harp-DAAL-Naive"><meta property="og:url" content="/docs/harpdaal/naive_bayes/"><meta property="og:description" content=""><meta name="twitter:description" content=""><title>harp Documentation - Harp-DAAL-Naive</title><link rel="stylesheet" href="https://dsc-spidal.github.io/harp/css/style.min.css"><link rel="stylesheet" href="https://dsc-spidal.github.io/harp/css/font-awesome.min.css"><link rel="stylesheet" href="https://dsc-spidal.github.io/harp/css/pygments.css"></head><body><nav class="hn-top-navbar navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="hn-navbar-container container-fluid"><div class="navbar-header"><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#hn-navbar" aria-controls="hn-navbar" aria-expanded="false"><span class="sr-only"><Toggle>navigation</Toggle></span><i class="hn-toggle-button fa fa-bars"></i></button><a class="hn-navbar-logo navbar-brand" href="https://dsc-spidal.github.io/harp/"><img class="pull-left" src="https://dsc-spidal.github.io/harp/img/0-1-2.png" width="76%"></a></div><div id="hn-navbar" class="navbar-collapse collapse"><ul class="nav navbar-nav navbar-right"><li><a href="https://dsc-spidal.github.io/harp/docs/getting-started">Documentation</a></li><li><a href="https://dsc-spidal.github.io/harp/api">API</a></li></ul></div></div></nav><div class="hn-main"><div class="container"><div class="row"><aside class="hn-sidebar hidden-xs col-sm-4 col-md-3 col-lg-2 collapse"><nav class="hn-sidebar-nav"><div id="hn-accordion-1" class="panel-group" role="tablist" aria-multiselectable="true"><div class="panel panel-default"><section id="installation-guide" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-1" href="#collapse-installation-guide" aria-labelledby="installation-guide"><i class="fa fa-caret-right"></i>Installation Guide</a></h4></section><div id="collapse-installation-guide" class="panel-collapse collapse" aria-labelledby="installation-guide"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/prerequisites">Prerequisites</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/getting-started">Harp Installation (Single Node)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/getting-started-cluster">Harp Installation (Cluster)</a></li></ul></div></div></div></div></nav><nav class="hn-sidebar-nav"><div id="hn-accordion-2" class="panel-group" role="tablist" aria-multiselectable="true"><div class="panel panel-default"><section id="beginners-guide" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-2" href="#collapse-beginners-guide" aria-labelledby="beginners-guide"><i class="fa fa-caret-right"></i>Beginners Guide</a></h4></section><div id="collapse-beginners-guide" class="panel-collapse collapse" aria-labelledby="beginners-guide"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/beginnersguide/mlr">Multiclass Logistic Regression</a></li></ul></div></div></div></div></nav><h2 class="panel-title"><b>Users Guide</b></h2><br><nav class="hn-sidebar-nav"><div id="hn-accordion-2" class="panel-group" role="tablist" aria-multiselectable="true"><div class="panel panel-default"><section id="applications" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-2" href="#collapse-applications" aria-labelledby="applications"><i class="fa fa-caret-right"></i>Applications</a></h4></section><div id="collapse-applications" class="panel-collapse collapse" aria-labelledby="applications"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/applications/lda-cgs">Latent Dirichlet Allocation (CGS)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/applications/mf">Matrix Factorization</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/applications/sahad">Subgraph Counting</a></li></ul></div></div></div></div></nav><h2 class="panel-title"><b>Contributors Guide</b></h2><br><nav class="hn-sidebar-nav"><div id="hn-accordion-3" class="panel-group" role="tablist" aria-multiselectable="true"><div class="panel panel-default"><section id="programming-guides" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-3" href="#collapse-programming-guides" aria-labelledby="programming-guides"><i class="fa fa-caret-right"></i>Programming Guides</a></h4></section><div id="collapse-programming-guides" class="panel-collapse collapse" aria-labelledby="programming-guides"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/programming/overview">Overview</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/programming/data-interface">Data Interfaces and Types</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/programming/scheduler">Schedulers</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/programming/computation-models">Computation Models</a></li></ul></div></div></div><div class="panel panel-default"><section id="collective-communication" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-3" href="#collapse-collective-communication" aria-labelledby="collective-communication"><i class="fa fa-caret-right"></i>Collective Communication</a></h4></section><div id="collapse-collective-communication" class="panel-collapse collapse" aria-labelledby="collective-communication"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/communications/broadcast">Broadcast</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/communications/reduce">Reduce</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/communications/allgather">Allgather</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/communications/allreduce">Allreduce</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/communications/regroup">Regroup</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/communications/pushandpull">Push &amp; Pull</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/communications/rotate">Rotate</a></li></ul></div></div></div><div class="panel panel-default"><section id="examples" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-3" href="#collapse-examples" aria-labelledby="examples"><i class="fa fa-caret-right"></i>Examples</a></h4></section><div id="collapse-examples" class="panel-collapse collapse" aria-labelledby="examples"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/examples/overview">Overview</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/examples/kmeans">K-Means</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/examples/mlrsgd">Multiclass Logistic Regression</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/examples/lda">Latent Dirichlet Allocation (CVB)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/examples/svm">Support Vector Machine</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/examples/rf">Random Forests</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/examples/nn">Neural Network</a></li></ul></div></div></div></div></nav><h2 class="panel-title"><b>Harp-DAAL Documentation</b></h2><br><nav class="hn-sidebar-nav"><div id="hn-accordion-4" class="panel-group" role="tablist" aria-multiselectable="true"><div class="panel panel-default"><section id="overview" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-4" href="#collapse-overview" aria-labelledby="overview"><i class="fa fa-caret-right"></i>Overview</a></h4></section><div id="collapse-overview" class="panel-collapse collapse" aria-labelledby="overview"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/harpdaal">Harp-DAAL framework</a></li></ul></div></div></div><div class="panel panel-default"><section id="harp-daal-apis" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-4" href="#collapse-harp-daal-apis" aria-labelledby="harp-daal-apis"><i class="fa fa-caret-right"></i>Harp-DAAL APIs</a></h4></section><div id="collapse-harp-daal-apis" class="panel-collapse collapse" aria-labelledby="harp-daal-apis"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/harpdaalInit">Initialization Module</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/harpdaalIO">I/O Module</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/harpdaalComm">Communication Module</a></li></ul></div></div></div><div class="panel panel-default"><section id="algorithms" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-4" href="#collapse-algorithms" aria-labelledby="algorithms"><i class="fa fa-caret-right"></i>Algorithms</a></h4></section><div id="collapse-algorithms" class="panel-collapse collapse" aria-labelledby="algorithms"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/kmeans">K-means</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/mfsgd">Matrix Factorization (SGD)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/als">Recommender System (ALS)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/svd">Singular Value Decomposition (SVD)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/pca">Principal Component Analysis (PCA)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/nn">Neural Network</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/qr">QR Decomposition (QR)</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/covariance">Covariance</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/moments">Low Order Moments</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/naive_bayes">Naive Bayes</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/linear_regression">Linear Regression</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/ridge_regression">Ridge Regression</a></li><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/subgraph">Subgraph Counting</a></li></ul></div></div></div><div class="panel panel-default"><section id="hands-on" class="panel-heading" role="tab"><h4 class="panel-title"><a role="button" data-toggle="collapse" data-parent="#hn-accordion-4" href="#collapse-hands-on" aria-labelledby="hands-on"><i class="fa fa-caret-right"></i>Hands-on</a></h4></section><div id="collapse-hands-on" class="panel-collapse collapse" aria-labelledby="hands-on"><div class="panel-body"><ul><li><a href="https://dsc-spidal.github.io/harp/docs/harpdaal/handson">Tutorial</a></li></ul></div></div></div></div></nav></aside><section class="hn-docs-main col-sm-8 col-md-9 col-lg-10 col-sm-offset-4 col-md-offset-3 col-lg-offset-2"><header class="hn-docs-header page-header"><h1>Harp-DAAL-Naive</h1><div class="hn-docs-description"></div></header><article class="hn-docs-content">

<h2 id="overview">Overview</h2>

<p>Naïve Bayes is a set of simple and powerful classification methods often used for text classification, medical diagnosis, and other classification problems. In spite of their main assumption about independence between features, Naïve Bayes classifiers often work well when this assumption does not hold. An advantage of this method is that it requires only a small amount of training data to estimate model parameters.</p>

<h2 id="implementation-of-harp-daal-naive">Implementation of Harp-DAAL-Naive</h2>

<p>Harp-DAAL-Naive is built upon the original DAAL distributed implementation of the algorithm using the Harp interface libraries for the collective-communication among the data nodes.
The implementation of Naive in our Harp-DAAL consists of two levels. At the top Level, using Harp’s reduce operation to communication model data among mappers. At the bottom Level, using DAAL’s  kernels to conduct local computations.</p>

<h3 id="brief-background">Brief background</h3>

<ul>
<li>There are primarily three kinds of nodes involved with the implementation.</li>
</ul>

<ol>
<li>name node</li>
<li>data node

<ul>
<li>master node</li>
<li>slave node</li>
</ul></li>
</ol>

<ul>
<li><p>The Java language services provided by Intel as a wrapper to their C++ code.</p></li>

<li><p>The description of the intel daal&rsquo;s JAVA API used can be found <a href="https://software.intel.com/sites/products/documentation/doclib/daal/daal-user-and-reference-guides/hh_goto.htm?index.htm#daal_java_api/group__multinomial__naive__bayes.htm">here</a></p></li>
</ul>

<h3 id="code-walk-through">Code Walk-Through</h3>

<p>The actual implemented code can be found <a href="https://github.com/DSC-SPIDAL/harp/tree/master/ml/daal/src/main/java/edu/iu/daal_naive">here</a>. The MapCollective function is defined <a href="https://github.com/DSC-SPIDAL/harp/blob/master/ml/daal/src/main/java/edu/iu/daal_naive/NaiveDaalCollectiveMapper.java">here</a>.</p>

<h4 id="step-1-on-data-nodes">Step 1 (on data nodes)</h4>

<p>The first step involves reading the files from the hdfs filesystem after splitting files between each mapper. Splitting is done by MultipleFileInputFormat class defined <a href="https://github.com/DSC-SPIDAL/harp/blob/master/ml/daal/src/main/java/edu/iu/fileformat/MultiFileInputFormat.java">here</a>.
Data is converted into array which is eventually converted into the daal <a href="https://software.intel.com/en-us/node/564579"><em>Numeric Table</em></a> datastructure.  In this example the files have been stored on the hdfs. The files have to be read in the daal table format as the local computations are performed by the daal libraries.
Getting array from csv file -</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #66d9ef">public</span> <span style="color: #66d9ef">static</span> <span style="color: #f8f8f2">List</span><span style="color: #f92672">&lt;</span><span style="color: #66d9ef">double</span><span style="color: #f92672">[]&gt;</span> <span style="color: #a6e22e">loadPoints</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">String</span> <span style="color: #f8f8f2">file</span><span style="color: #f92672">,</span>
<span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">pointsPerFile</span><span style="color: #f92672">,</span> <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">cenVecSize</span><span style="color: #f92672">,</span>
<span style="color: #f8f8f2">Configuration</span> <span style="color: #f8f8f2">conf</span><span style="color: #f92672">)</span> <span style="color: #66d9ef">throws</span> <span style="color: #f8f8f2">Exception</span> <span style="color: #f92672">{</span>
  <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">out</span><span style="color: #f92672">.</span><span style="color: #a6e22e">println</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;filename: &quot;</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">file</span> <span style="color: #f92672">);</span>
  <span style="color: #f8f8f2">List</span><span style="color: #f92672">&lt;</span><span style="color: #66d9ef">double</span><span style="color: #f92672">[]&gt;</span> <span style="color: #f8f8f2">points</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">LinkedList</span><span style="color: #f92672">&lt;</span><span style="color: #66d9ef">double</span><span style="color: #f92672">[]&gt;();</span>
  <span style="color: #66d9ef">double</span><span style="color: #f92672">[]</span> <span style="color: #f8f8f2">trainingData</span> <span style="color: #f92672">=</span>
    <span style="color: #66d9ef">new</span> <span style="color: #66d9ef">double</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">pointsPerFile</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">cenVecSize</span><span style="color: #f92672">];</span>
    <span style="color: #66d9ef">double</span><span style="color: #f92672">[]</span> <span style="color: #f8f8f2">labelData</span> <span style="color: #f92672">=</span>
    <span style="color: #66d9ef">new</span> <span style="color: #66d9ef">double</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">pointsPerFile</span> <span style="color: #f92672">*</span> <span style="color: #ae81ff">1</span><span style="color: #f92672">];</span> 
  <span style="color: #f8f8f2">Path</span> <span style="color: #f8f8f2">pointFilePath</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">Path</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">file</span><span style="color: #f92672">);</span>
  <span style="color: #f8f8f2">FileSystem</span> <span style="color: #f8f8f2">fs</span> <span style="color: #f92672">=</span>
    <span style="color: #f8f8f2">pointFilePath</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getFileSystem</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">conf</span><span style="color: #f92672">);</span>
  <span style="color: #f8f8f2">FSDataInputStream</span> <span style="color: #f8f8f2">in</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">fs</span><span style="color: #f92672">.</span><span style="color: #a6e22e">open</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">pointFilePath</span><span style="color: #f92672">);</span>
  <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">k</span> <span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f92672">;</span>
  <span style="color: #66d9ef">try</span><span style="color: #f92672">{</span>
    <span style="color: #66d9ef">for</span><span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">pointsPerFile</span><span style="color: #f92672">;</span><span style="color: #f8f8f2">i</span><span style="color: #f92672">++){</span>
      <span style="color: #f8f8f2">String</span><span style="color: #f92672">[]</span> <span style="color: #f8f8f2">line</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">in</span><span style="color: #f92672">.</span><span style="color: #a6e22e">readLine</span><span style="color: #f92672">().</span><span style="color: #a6e22e">split</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;,&quot;</span><span style="color: #f92672">);</span>
      <span style="color: #66d9ef">for</span><span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">j</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">j</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">cenVecSize</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">j</span><span style="color: #f92672">++){</span>
        <span style="color: #f8f8f2">trainingData</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Double</span><span style="color: #f92672">.</span><span style="color: #a6e22e">parseDouble</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">line</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">j</span><span style="color: #f92672">]);</span>
        <span style="color: #f8f8f2">k</span><span style="color: #f92672">++;</span>
      <span style="color: #f92672">}</span>
      <span style="color: #f8f8f2">labelData</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">i</span><span style="color: #f92672">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">Double</span><span style="color: #f92672">.</span><span style="color: #a6e22e">parseDouble</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">line</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">cenVecSize</span><span style="color: #f92672">]);</span>
    <span style="color: #f92672">}</span>
  <span style="color: #f92672">}</span> <span style="color: #66d9ef">finally</span><span style="color: #f92672">{</span>
    <span style="color: #f8f8f2">in</span><span style="color: #f92672">.</span><span style="color: #a6e22e">close</span><span style="color: #f92672">();</span>
    <span style="color: #f8f8f2">points</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">trainingData</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">points</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">labelData</span><span style="color: #f92672">);</span>
  <span style="color: #f92672">}</span>
<span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">points</span><span style="color: #f92672">;</span>
<span style="color: #f92672">}</span>
</pre></div>

<p>Converting array to Numeric Table -</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">List</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">List</span><span style="color: #f92672">&lt;</span><span style="color: #66d9ef">double</span><span style="color: #f92672">[]&gt;&gt;</span> <span style="color: #f8f8f2">pointArrays</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">NaiveUtil</span><span style="color: #f92672">.</span><span style="color: #a6e22e">loadPoints</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">trainingDataFiles</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">pointsPerFile</span><span style="color: #f92672">,</span>
                    <span style="color: #f8f8f2">vectorSize</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">conf</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">numThreads</span><span style="color: #f92672">);</span>
      <span style="color: #f8f8f2">List</span><span style="color: #f92672">&lt;</span><span style="color: #66d9ef">double</span><span style="color: #f92672">[]&gt;</span> <span style="color: #f8f8f2">featurePoints</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">LinkedList</span><span style="color: #f92672">&lt;&gt;();</span>
      <span style="color: #66d9ef">for</span><span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">i</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">pointArrays</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">();</span> <span style="color: #f8f8f2">i</span><span style="color: #f92672">++){</span>
          <span style="color: #f8f8f2">featurePoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">pointArrays</span><span style="color: #f92672">.</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">i</span><span style="color: #f92672">).</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #ae81ff">0</span><span style="color: #f92672">));</span>
      <span style="color: #f92672">}</span>
      <span style="color: #f8f8f2">List</span><span style="color: #f92672">&lt;</span><span style="color: #66d9ef">double</span><span style="color: #f92672">[]&gt;</span> <span style="color: #f8f8f2">labelPoints</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">LinkedList</span><span style="color: #f92672">&lt;&gt;();</span>
      <span style="color: #66d9ef">for</span><span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">i</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">pointArrays</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">();</span> <span style="color: #f8f8f2">i</span><span style="color: #f92672">++){</span>
          <span style="color: #f8f8f2">labelPoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">pointArrays</span><span style="color: #f92672">.</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">i</span><span style="color: #f92672">).</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #ae81ff">1</span><span style="color: #f92672">));</span>
      <span style="color: #f92672">}</span>

      <span style="color: #f8f8f2">ts2</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">currentTimeMillis</span><span style="color: #f92672">();</span>
      <span style="color: #f8f8f2">load_time</span> <span style="color: #f92672">+=</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">ts2</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">ts1</span><span style="color: #f92672">);</span>



    <span style="color: #75715e">// converting data to Numeric Table</span>
      <span style="color: #f8f8f2">ts1</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">currentTimeMillis</span><span style="color: #f92672">();</span>

      <span style="color: #66d9ef">long</span> <span style="color: #f8f8f2">nFeature</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">vectorSize</span><span style="color: #f92672">;</span>
      <span style="color: #66d9ef">long</span> <span style="color: #f8f8f2">nLabel</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span><span style="color: #f92672">;</span>
      <span style="color: #66d9ef">long</span> <span style="color: #f8f8f2">totalLengthFeature</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span>
      <span style="color: #66d9ef">long</span> <span style="color: #f8f8f2">totalLengthLabel</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span>

      <span style="color: #66d9ef">long</span><span style="color: #f92672">[]</span> <span style="color: #f8f8f2">array_startP_feature</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #66d9ef">long</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">pointArrays</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">()];</span>
      <span style="color: #66d9ef">double</span><span style="color: #f92672">[][]</span> <span style="color: #f8f8f2">array_data_feature</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #66d9ef">double</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">pointArrays</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">()][];</span>
      <span style="color: #66d9ef">long</span><span style="color: #f92672">[]</span> <span style="color: #f8f8f2">array_startP_label</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #66d9ef">long</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">labelPoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">()];</span>
      <span style="color: #66d9ef">double</span><span style="color: #f92672">[][]</span> <span style="color: #f8f8f2">array_data_label</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #66d9ef">double</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">labelPoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">()][];</span>

      <span style="color: #66d9ef">for</span><span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f92672">;</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">featurePoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">();</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">++)</span>
            <span style="color: #f92672">{</span>
                <span style="color: #f8f8f2">array_data_feature</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">featurePoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">);</span>
                <span style="color: #f8f8f2">array_startP_feature</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">totalLengthFeature</span><span style="color: #f92672">;</span>
                <span style="color: #f8f8f2">totalLengthFeature</span> <span style="color: #f92672">+=</span> <span style="color: #f8f8f2">featurePoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">).</span><span style="color: #a6e22e">length</span><span style="color: #f92672">;</span>
            <span style="color: #f92672">}</span>

      <span style="color: #66d9ef">for</span><span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f92672">;</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">labelPoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">();</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">++)</span>
      <span style="color: #f92672">{</span>
          <span style="color: #f8f8f2">array_data_label</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">labelPoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">);</span>
          <span style="color: #f8f8f2">array_startP_label</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">]</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">totalLengthLabel</span><span style="color: #f92672">;</span>
          <span style="color: #f8f8f2">totalLengthLabel</span> <span style="color: #f92672">+=</span> <span style="color: #f8f8f2">labelPoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">get</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">).</span><span style="color: #a6e22e">length</span><span style="color: #f92672">;</span>
      <span style="color: #f92672">}</span>

    <span style="color: #66d9ef">long</span> <span style="color: #f8f8f2">featuretableSize</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">totalLengthFeature</span><span style="color: #f92672">/</span><span style="color: #f8f8f2">nFeature</span><span style="color: #f92672">;</span>
    <span style="color: #66d9ef">long</span> <span style="color: #f8f8f2">labeltableSize</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">totalLengthLabel</span><span style="color: #f92672">/</span><span style="color: #f8f8f2">nLabel</span><span style="color: #f92672">;</span>

   <span style="color: #75715e">//initializing Numeric Table</span>


    <span style="color: #f8f8f2">NumericTable</span> <span style="color: #f8f8f2">featureArray_daal</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">HomogenNumericTable</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">daal_Context</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Double</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">nFeature</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">featuretableSize</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">NumericTable</span><span style="color: #f92672">.</span><span style="color: #a6e22e">AllocationFlag</span><span style="color: #f92672">.</span><span style="color: #a6e22e">DoAllocate</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">NumericTable</span> <span style="color: #f8f8f2">labelArray_daal</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">HomogenNumericTable</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">daal_Context</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Double</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">nLabel</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">labeltableSize</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">NumericTable</span><span style="color: #f92672">.</span><span style="color: #a6e22e">AllocationFlag</span><span style="color: #f92672">.</span><span style="color: #a6e22e">DoAllocate</span><span style="color: #f92672">);</span>


    <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">row_idx_feature</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span>
    <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">row_len_feature</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span>

    <span style="color: #66d9ef">for</span> <span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">featurePoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">();</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">++)</span> 
      <span style="color: #f92672">{</span>
          <span style="color: #f8f8f2">row_len_feature</span> <span style="color: #f92672">=</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">array_data_feature</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">].</span><span style="color: #a6e22e">length</span><span style="color: #f92672">)/(</span><span style="color: #66d9ef">int</span><span style="color: #f92672">)</span><span style="color: #f8f8f2">nFeature</span><span style="color: #f92672">;</span>
          <span style="color: #75715e">//release data from Java side to native side</span>
          <span style="color: #f92672">((</span><span style="color: #f8f8f2">HomogenNumericTable</span><span style="color: #f92672">)</span><span style="color: #f8f8f2">featureArray_daal</span><span style="color: #f92672">).</span><span style="color: #a6e22e">releaseBlockOfRows</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">row_idx_feature</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">row_len_feature</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">DoubleBuffer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">wrap</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">array_data_feature</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">]));</span>
          <span style="color: #f8f8f2">row_idx_feature</span> <span style="color: #f92672">+=</span> <span style="color: #f8f8f2">row_len_feature</span><span style="color: #f92672">;</span>
      <span style="color: #f92672">}</span>

    <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">row_idx_label</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span>
    <span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">row_len_label</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span>

    <span style="color: #66d9ef">for</span> <span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">=</span><span style="color: #ae81ff">0</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">&lt;</span><span style="color: #f8f8f2">labelPoints</span><span style="color: #f92672">.</span><span style="color: #a6e22e">size</span><span style="color: #f92672">();</span> <span style="color: #f8f8f2">k</span><span style="color: #f92672">++)</span> 
    <span style="color: #f92672">{</span>
        <span style="color: #f8f8f2">row_len_label</span> <span style="color: #f92672">=</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">array_data_label</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">].</span><span style="color: #a6e22e">length</span><span style="color: #f92672">)/(</span><span style="color: #66d9ef">int</span><span style="color: #f92672">)</span><span style="color: #f8f8f2">nLabel</span><span style="color: #f92672">;</span>
        <span style="color: #75715e">//release data from Java side to native side</span>
        <span style="color: #f92672">((</span><span style="color: #f8f8f2">HomogenNumericTable</span><span style="color: #f92672">)</span><span style="color: #f8f8f2">labelArray_daal</span><span style="color: #f92672">).</span><span style="color: #a6e22e">releaseBlockOfRows</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">row_idx_label</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">row_len_label</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">DoubleBuffer</span><span style="color: #f92672">.</span><span style="color: #a6e22e">wrap</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">array_data_label</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">k</span><span style="color: #f92672">]));</span>
        <span style="color: #f8f8f2">row_idx_label</span> <span style="color: #f92672">+=</span> <span style="color: #f8f8f2">row_len_label</span><span style="color: #f92672">;</span>
    <span style="color: #f92672">}</span>
</pre></div>

<h4 id="step-2-on-data-nodes">Step 2 (on data nodes)</h4>

<p>TrainingDistributedStep1Local is created for local computation. Computed partial results are sent to master node by <strong>reduce</strong> function.</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">TrainingDistributedStep1Local</span> <span style="color: #f8f8f2">algorithm</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TrainingDistributedStep1Local</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">localContext</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Float</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">,</span>
                    <span style="color: #f8f8f2">TrainingMethod</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultDense</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">nClasses</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">algorithm</span><span style="color: #f92672">.</span><span style="color: #a6e22e">input</span><span style="color: #f92672">.</span><span style="color: #a6e22e">set</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">InputId</span><span style="color: #f92672">.</span><span style="color: #a6e22e">data</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">featureArray_daal</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">algorithm</span><span style="color: #f92672">.</span><span style="color: #a6e22e">input</span><span style="color: #f92672">.</span><span style="color: #a6e22e">set</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">InputId</span><span style="color: #f92672">.</span><span style="color: #a6e22e">labels</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">labelArray_daal</span><span style="color: #f92672">);</span>

    <span style="color: #f8f8f2">TrainingPartialResult</span> <span style="color: #f8f8f2">pres</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">algorithm</span><span style="color: #f92672">.</span><span style="color: #a6e22e">compute</span><span style="color: #f92672">();</span>
    <span style="color: #f8f8f2">pres</span><span style="color: #f92672">.</span><span style="color: #a6e22e">changeContext</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">daal_Context</span><span style="color: #f92672">);</span>
    <span style="color: #f8f8f2">localContext</span><span style="color: #f92672">.</span><span style="color: #a6e22e">dispose</span><span style="color: #f92672">();</span>
    <span style="color: #f8f8f2">ts2</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">currentTimeMillis</span><span style="color: #f92672">();</span>
    <span style="color: #f8f8f2">compute_time</span> <span style="color: #f92672">+=</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">ts2</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">ts1</span><span style="color: #f92672">);</span>

    <span style="color: #f8f8f2">ts1</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">currentTimeMillis</span><span style="color: #f92672">();</span>
    <span style="color: #f8f8f2">partialResultTable</span><span style="color: #f92672">.</span><span style="color: #a6e22e">addPartition</span><span style="color: #f92672">(</span><span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">Partition</span><span style="color: #f92672">&lt;&gt;(</span><span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getSelfID</span><span style="color: #f92672">(),</span> <span style="color: #f8f8f2">serializePartialResult</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">pres</span><span style="color: #f92672">)));</span>
    <span style="color: #66d9ef">boolean</span> <span style="color: #f8f8f2">reduceStatus</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">false</span><span style="color: #f92672">;</span>
    <span style="color: #f8f8f2">reduceStatus</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">reduce</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;naive&quot;</span><span style="color: #f92672">,</span> <span style="color: #e6db74">&quot;sync-partialresult&quot;</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">partialResultTable</span><span style="color: #f92672">,</span> <span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getMasterID</span><span style="color: #f92672">());</span>
</pre></div>

<h4 id="step-3-only-on-master-nodes">Step 3 (only on master nodes)</h4>

<p>Final result is computed on master node.</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span> <span style="color: #66d9ef">if</span><span style="color: #f92672">(</span><span style="color: #66d9ef">this</span><span style="color: #f92672">.</span><span style="color: #a6e22e">isMaster</span><span style="color: #f92672">()){</span>
     <span style="color: #f8f8f2">TrainingDistributedStep2Master</span> <span style="color: #f8f8f2">masterAlgorithm</span> <span style="color: #f92672">=</span> <span style="color: #66d9ef">new</span> <span style="color: #f8f8f2">TrainingDistributedStep2Master</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">daal_Context</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">Float</span><span style="color: #f92672">.</span><span style="color: #a6e22e">class</span><span style="color: #f92672">,</span>
                <span style="color: #f8f8f2">TrainingMethod</span><span style="color: #f92672">.</span><span style="color: #a6e22e">defaultDense</span><span style="color: #f92672">,</span> <span style="color: #f8f8f2">nClasses</span><span style="color: #f92672">);</span>
      <span style="color: #f8f8f2">ts1</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">currentTimeMillis</span><span style="color: #f92672">();</span>
      <span style="color: #66d9ef">int</span><span style="color: #f92672">[]</span> <span style="color: #f8f8f2">pid</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">partialResultTable</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getPartitionIDs</span><span style="color: #f92672">().</span><span style="color: #a6e22e">toIntArray</span><span style="color: #f92672">();</span>
      <span style="color: #66d9ef">for</span><span style="color: #f92672">(</span><span style="color: #66d9ef">int</span> <span style="color: #f8f8f2">j</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">j</span><span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">pid</span><span style="color: #f92672">.</span><span style="color: #a6e22e">length</span><span style="color: #f92672">;</span> <span style="color: #f8f8f2">j</span><span style="color: #f92672">++){</span>
        <span style="color: #66d9ef">try</span> <span style="color: #f92672">{</span>
          <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">out</span><span style="color: #f92672">.</span><span style="color: #a6e22e">println</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;pid : &quot;</span><span style="color: #f92672">+</span><span style="color: #f8f8f2">pid</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">j</span><span style="color: #f92672">]);</span>
          <span style="color: #f8f8f2">masterAlgorithm</span><span style="color: #f92672">.</span><span style="color: #a6e22e">input</span><span style="color: #f92672">.</span><span style="color: #a6e22e">add</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">TrainingDistributedInputId</span><span style="color: #f92672">.</span><span style="color: #a6e22e">partialModels</span><span style="color: #f92672">,</span>
          <span style="color: #f8f8f2">deserializePartialResult</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">partialResultTable</span><span style="color: #f92672">.</span><span style="color: #a6e22e">getPartition</span><span style="color: #f92672">(</span><span style="color: #f8f8f2">pid</span><span style="color: #f92672">[</span><span style="color: #f8f8f2">j</span><span style="color: #f92672">]).</span><span style="color: #a6e22e">get</span><span style="color: #f92672">()));</span> 
        <span style="color: #f92672">}</span> <span style="color: #66d9ef">catch</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">Exception</span> <span style="color: #f8f8f2">e</span><span style="color: #f92672">)</span> 
          <span style="color: #f92672">{</span>  
            <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">out</span><span style="color: #f92672">.</span><span style="color: #a6e22e">println</span><span style="color: #f92672">(</span><span style="color: #e6db74">&quot;Fail to deserilize partialResultTable&quot;</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">e</span><span style="color: #f92672">.</span><span style="color: #a6e22e">toString</span><span style="color: #f92672">());</span>
            <span style="color: #f8f8f2">e</span><span style="color: #f92672">.</span><span style="color: #a6e22e">printStackTrace</span><span style="color: #f92672">();</span>
          <span style="color: #f92672">}</span>
      <span style="color: #f92672">}</span>
      <span style="color: #f8f8f2">ts2</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">currentTimeMillis</span><span style="color: #f92672">();</span>
      <span style="color: #f8f8f2">comm_time</span> <span style="color: #f92672">+=</span> <span style="color: #f92672">(</span><span style="color: #f8f8f2">ts2</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">ts1</span><span style="color: #f92672">);</span>

      <span style="color: #f8f8f2">ts1</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">System</span><span style="color: #f92672">.</span><span style="color: #a6e22e">currentTimeMillis</span><span style="color: #f92672">();</span>
      <span style="color: #f8f8f2">masterAlgorithm</span><span style="color: #f92672">.</span><span style="color: #a6e22e">compute</span><span style="color: #f92672">();</span>
      <span style="color: #f8f8f2">trainingResult</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">masterAlgorithm</span><span style="color: #f92672">.</span><span style="color: #a6e22e">finalizeCompute</span><span style="color: #f92672">();</span>
    <span style="color: #f92672">}</span>
</pre></div>

<h2 id="running-the-codes">Running the codes</h2>

<p>Make sure that the code is placed in the <code>/harp/ml/daal</code> directory.
Run the <code>harp-daal-naive.sh</code> script here to run the code.</p>
<div class="highlight" style="background: #272822"><pre style="line-height: 125%"><span></span><span style="color: #f8f8f2">cd</span> <span style="color: #f8f8f2">$HARP_ROOT</span>/ml/daal
./test_scripts/harp-daal-naive.sh
</pre></div>

<p>The details of script is <a href="https://github.com/DSC-SPIDAL/harp/blob/master/ml/daal/test_scripts/harp-daal-naive.sh">here</a></p>
</article></section></div></div></div><script src="https://code.jquery.com/jquery-2.2.1.min.js"></script><script src="https://dsc-spidal.github.io/harp/js/app.min.js"></script></body></html>